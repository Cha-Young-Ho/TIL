# 목차

* 인덱스란?
* 인덱스 종류
* 자동 인덱스
* 인덱스 내부작동


# 인덱스란?
![image](https://user-images.githubusercontent.com/79268661/183885071-2c26d192-396e-4ab8-9b0d-6cbceac753d6.png)

인덱스란 데이터베이스 테이블에 대한 검색 성능의 속도를 높여주는 자료 구조이다.

예를 들어 설명하면 도서에서 목차라고 생각하면 된다.

특정 컬럼에 인덱스를 생성하면, 해당 컬럼의 데이터들을 알맞게 정렬해서 별도의 다른 공간에 해당 DB 데이터 물리적 주소가 함께 저장된다.

인덱스를 생성한 후, 작업을 하면 옵티마이저에서 판단해서 생성된 인덱스를 조회하고 데이터에 접근을 할 수 있다.

## 장점
데이터를 알맞게 정렬하는 과정을 거치기 때문에 조건 검색에서 성능을 높여줄 수 있다.

* WHERE에서 성능이점을 얻을 수 있다.
* ORDER BY에서 성능이점을 얻을 수 있다.
* MIN, MAX에서 성능이점을 얻을 수 있다.

## 단점
인덱스를 사용하면 추가, 삭제, 수정 시 데이터를 계속해서 정렬하는 과정을 거치게 된다.
데이터 내용이 변경되면 다시 정렬을 해야하는 과정을 거치기 떄문에 성능상 좋지 못한 부분이 생긴다.

## 전략
인덱스를 효율적으로 사용하기 위해서는 조건절의 호출 빈도가 높고, 데이터 분포도가 넓은 컬럼을 기준으로 생성하는 것이 좋다.
또한 생성, 수정, 삭제가 자주 일어나는 데이터에 생성하면 좋지 않다.

1. 조건절에 자주 등장하는 컬럼
2. 항상 = 으로 비교되는 컬럼
3. 중복되는 데이터가 최소화되는 컬럼
4. order by 절에서 자주 사용되는 컬럼
5. 조인 조건으로 자주 사용되는 컬럼




# 인덱스 종류
1. 클러스터형 인덱스 : 내용 자체로 정렬하는 것이다.
2. 보조 인덱스 : 내용과 상관없이 찾아보기 페이지 처럼 정리를 해놓는 것이다.
3. 결합 인덱스 : 여러가지 컬럼을 합쳐서 인덱스를 생성하는 것을 말한다.

## 클러스터형 인덱스
내용 자체로 정렬되는 인덱스이다.
데이터가 새롭게 추가될 때 마다 정렬이 진행된다. 그래서 해당 데이터 자체로 인덱스가 된다.

## 보조 인덱스
정렬없이 key, value로 가지고 있는 인덱스이다.

## 결합 인덱스
결합 인덱스는 2개 이상의 컬럼을 합쳐서 인덱스를 생성하는 것을 말한다.
주로 다음과 같은 상황에서 생성된다.
1. where 절에서 and 조건으로 자주 결합되어 사용되는 컬럼들
2. 다른 테이블과 조인의 연결고리로 자주 사용되는 컬럼
3. order by에서 자주 사용되는 컬럼들
4. 하나 이상의 키 컬럼 조건으로 같은 테이블의 컬럼들이 자주 조회될 때

### 결합 인덱스 순서
1. where 조건으로 많이 사용되는 컬럼이 우선
2. Equal로 사용되는 컬럼 우선
3. 분포도가 좋은 컬럼 우선

### 결합 인덱스 생성

```sql
CREATE index test_index on user(주민번호, 지역);
```

### 결합 인덱스 사용하기
```sql
SELECT * FROM user WHERE 주민번호 = '900101';
SELECT * FROM user WHERE 주민번호 = '901010' AND 지역 = '경상남도';
```
다음과 같은 상황은 결합 인덱스를 사용하지 않는다.

```sql
SELECT * FROM user WHERE 지역 = '경상남도';
```

결합 인덱스의 첫번째 컬럼인 주민번호에서 인덱스가 조합되지 않기떄문에 사용되지 않는다.

# 자동 인덱스
자동 인덱스란 데이터베이스의 컬럼을 정의하고 데이터를 INSERT할 때 자동으로 생성되는 인덱스를 말한다.

보통 2가지 상황에서 인덱스가 생성된다.
## Primary key
PK로 어떠한 내용을 생성하면 _**클러스터형 인덱스**_가 생성된다.

## Unique key
Unique key로 어떠한 내용을 생성하면 _**보조 인덱스**_가 생성된다.

# 인덱스 내부작동
![image](https://user-images.githubusercontent.com/79268661/183885094-da37bb71-630d-45f3-9ddc-5bea4eebff73.png)

> 인덱스는 내부적으로 B - Tree 자료구조를 이용한다.

# 참고
[코딩팩토리 인덱스글](https://coding-factory.tistory.com/746)

